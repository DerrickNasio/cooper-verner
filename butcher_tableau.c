/* This file contains the elements of the Butcher tableau used by this particular numerical ODE solver. */
#include "Verner.h"

// Shared abscissae
const double RK_c[NUMBER_OF_STAGES] = {
	0.0,
	1.0 / 2.0,
	1.0 / 2.0,
	(7.0 + sqrt21) / 14.0,
	(7.0 + sqrt21) / 14.0,
	1.0 / 2.0,
	(7.0 - sqrt21) / 14.0,
	(7.0 - sqrt21) / 14.0,
	1.0 / 2.0,
	(7.0 + sqrt21) / 14.0,
	1.0
};

// Stage weights for final sum
const double RK_b[NUMBER_OF_STAGES] = {
    1.0 / 20.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    49.0 / 180.0,
    16.0 / 45.0,
    49.0 / 180.0,
    1.0 / 20.0
};

// Matrix elements
const double RK_A[NUMBER_OF_STAGES][NUMBER_OF_STAGES] = {
    {0.0},
    {1.0 / 2.0},
    {1.0 / 4.0,
     1.0 / 4.0},
    {1.0 / 7.0,
     -(7.0 + 3.0 * sqrt21) / 98.0,
     (21.0 + 5.0 * sqrt21) / 49.0},
    {(11.0 + sqrt21) / 84.0,
     0.0,
     (18.0 + 4.0 * sqrt21) / 63.0,
     (21.0 - sqrt21) / 252.0},
    {(5.0 + sqrt21) / 48.0,
     0.0,
     (9.0 + sqrt21) / 36.0,
     (-231.0 + 14.0 * sqrt21) / 360.0,
     (63.0 - 7.0 * sqrt21) / 80.0},
    {(10.0 - sqrt21) / 42.0,
     0.0,
     (-432.0 + 92.0 * sqrt21) / 315.0,
     (633.0 - 145.0 * sqrt21) / 90.0,
     (-504.0 + 115.0 * sqrt21) / 70.0,
     (63.0 - 13.0 * sqrt21) / 35.0},
    {1.0 / 14.0,
     0.0,
     0.0,
     0.0,
     (14.0 - 3.0 * sqrt21) / 126.0,
     (13.0 - 3.0 * sqrt21) / 63.0,
     1.0 / 9.0},
    {1.0 / 32.0,
     0.0,
     0.0,
     0.0,
     (91.0 - 21.0 * sqrt21) / 576.0,
     11.0 / 72.0,
     -(385.0 + 75.0 * sqrt21) / 1152.0,
     (63.0 + 13.0 * sqrt21) / 128.0},
    {1.0 / 14.0,
     0.0,
     0.0,
     0.0,
     1.0 / 9.0,
     -(733.0 + 147.0 * sqrt21) / 2205.0,
     (515.0 + 111.0 * sqrt21) / 504.0,
     -(51.0 + 11.0 * sqrt21) / 56.0,
     (132.0 + 28.0 * sqrt21) / 245.0},
    {0.0,
     0.0,
     0.0,
     0.0,
     (-42.0 + 7.0 * sqrt21) / 18.0,
     (-18.0 + 28.0 * sqrt21) / 45.0,
     -(273.0 + 53.0 * sqrt21) / 72.0,
     (301.0 + 53.0 * sqrt21) / 72.0,
     (28.0 - 28.0 * sqrt21) / 45.0,
     (49.0 - 7.0 * sqrt21) / 18.0}
};
